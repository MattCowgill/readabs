test_that("read_abs_api works", {
  # Different URL formats: legacy ABS.stat, data explorer (beta), and data
  # explorer (prod)

  alcohol <- "https://api.data.abs.gov.au/data/ABS,ALC,1.0.0/1.1+2.1+2+3+4+5.6+10+11+12+14+15.A?startPeriod=2000&dimensionAtObservation=AllDimensions"

  lf <- "https://api.data.abs.gov.au/data/ABS,LF,1.0.0/M9.3.1599.30+10+20.AUS.M?startPeriod=2021-01&dimensionAtObservation=AllDimensions"


  lf_time <- "https://api.data.abs.gov.au/data/ABS,LF,1.0.0/M9.3.1599.30+10+20.AUS.M?startPeriod=2020-01&endPeriod=2021-12&dimensionAtObservation=AllDimensions"

  turnover <- "https://api.data.abs.gov.au/data/ABS,BUSINESS_TURNOVER,1.0.0/....AUS.M?startPeriod=2020-07&dimensionAtObservation=AllDimensions"

  erp <- "https://api.data.abs.gov.au/data/ABS,ABS_ANNUAL_ERP_ASGS2016,1.0.0/.STE.10102+10103+10104+10105+10106+10201+10202+10301+10302+10303+10304+10401+10402+10501+10502+10503+10601+10602+10603+10604+10701+10702+10703+10704+10801+10802+10803+10804+10805+10901+10902+10903+11001+11002+11003+11004+11101+11102+11103+11201+11202+11203+11301+11302+11303+11401+11402+11501+11502+11503+11504+11601+11602+11603+11701+11702+11703+11801+11802+11901+11902+11903+11904+12001+12002+12003+12101+12102+12103+12104+12201+12202+12203+12301+12302+12303+12401+12402+12403+12404+12405+12501+12502+12503+12504+12601+12602+12701+12702+12703+12801+12802+19499+19797+19999+20101+20102+20103+20201+20202+20203+20301+20302+20303+20401+20402+20403+20501+20502+20503+20504+20505+20601+20602+20603+20604+20605+20606+20607+20701+20702+20703+20801+20802+20803+20804+20901+20902+20903+20904+21001+21002+21003+21004+21005+21101+21102+21103+21104+21105+21201+21202+21203+21204+21205+21301+21302+21303+21304+21305+21401+21402+21501+21502+21503+21601+21602+21603+21701+21703+21704+29499+29797+29999+30101+30102+30103+30201+30202+30203+30204+30301+30302+30303+30304+30305+30306+30401+30402+30403+30404+30501+30502+30503+30504+30601+30602+30603+30604+30605+30701+30702+30703+30801+30803+30804+30805+30901+30902+30903+30904+30905+30906+30907+30908+30909+30910+31001+31002+31003+31004+31101+31102+31103+31104+31105+31106+31201+31202+31203+31301+31302+31303+31304+31305+31401+31402+31403+31501+31502+31503+31601+31602+31603+31605+31606+31607+31608+31701+31801+31802+31901+31902+31903+31904+31905+39499+39797+39999+40101+40102+40103+40104+40105+40106+40107+40201+40202+40203+40204+40205+40301+40302+40303+40304+40401+40402+40403+40501+40502+40503+40504+40601+40602+40701+40702+40703+49499+49797+49999+50101+50102+50103+50201+50301+50302+50401+50402+50403+50501+50502+50503+50601+50602+50603+50604+50605+50606+50607+50701+50702+50703+50704+50705+50901+50902+50903+51001+51002+51003+51101+51102+51103+51104+59499+59797+59999+60101+60102+60103+60104+60105+60106+60201+60202+60203+60301+60302+60303+60401+60402+60403+69499+69797+69999+70101+70102+70103+70104+70201+70202+70203+70204+70205+79499+79797+79999+80101+80103+80104+80105+80106+80107+80108+80109+80110+80111+89499+89797+89999+90101+90102+90103+90104+99499+99797+99799+99999+101+102+103+104+105+106+107+108+109+110+111+112+113+114+115+116+117+118+119+120+121+122+123+124+125+126+127+128+194+197+199+201+202+203+204+205+206+207+208+209+210+211+212+213+214+215+216+217+294+297+299+301+302+303+304+305+306+307+308+309+310+311+312+313+314+315+316+317+318+319+394+397+399+401+402+403+404+405+406+407+494+497+499+501+502+503+504+505+506+507+509+510+511+594+597+599+601+602+603+604+694+697+699+701+702+794+797+799+801+894+897+899+901+994+997+999+1GSYD+1RNSW+19799+2GMEL+2RVIC+29799+3GBRI+3RQLD+39799+4GADE+4RSAU+49799+5GPER+5RWAU+59799+6GHOB+6RTAS+69799+7GDAR+7RNTE+79799+8ACTE+89799+9OTER+1+2+3+4+5+6+7+8+9.A?startPeriod=2001&dimensionAtObservation=AllDimensions"



  erp2 <- "https://api.data.abs.gov.au/data/ABS,ABS_ANNUAL_ERP_LGA2020,1.0.0/.3..10050+10180+10250+10300+10470+10500+10550+10600+10650+10750+10800+10850+10900+10950+11150+11200+11250+11300+11350+11400+11450+11500+11520+11570+11600+11650+11700+11720+11730+11750+11800+12000+12150+12160+12350+12380+12390+12700+12730+12750+12850+12870+12900+12930+12950+13010+13310+13340+13450+13550+13660+13800+13850+13910+14000+14100+14170+14220+14300+14350+14400+14500+14550+14600+14650+14700+14750+14850+14870+14900+14920+14950+15050+15240+15270+15300+15350+15520+15560+15650+15700+15750+15800+15850+15900+15950+15990+16100+16150+16200+16260+16350+16380+16400+16490+16550+16610+16700+16900+16950+17000+17040+17080+17100+17150+17200+17310+17350+17400+17420+17550+17620+17640+17650+17750+17850+17900+17950+18020+18050+18100+18200+18250+18350+18400+18450+18500+18710+19399+19499+19799+20110+20260+20570+20660+20740+20830+20910+21010+21110+21180+21270+21370+21450+21610+21670+21750+21830+21890+22110+22170+22250+22310+22410+22490+22620+22670+22750+22830+22910+22980+23110+23190+23270+23350+23430+23670+23810+23940+24130+24210+24250+24330+24410+24600+24650+24780+24850+24900+24970+25060+25150+25250+25340+25430+25490+25620+25710+25810+25900+25990+26080+26170+26260+26350+26430+26490+26610+26670+26700+26730+26810+26890+26980+27070+27170+27260+27350+27450+27630+29399+29499+29799+30250+30300+30370+30410+30450+30760+30900+31000+31750+31820+31900+31950+32080+32250+32260+32270+32310+32330+32450+32500+32600+32750+32770+32810+33100+33200+33220+33360+33430+33610+33620+33800+33830+33960+33980+34420+34530+34570+34580+34590+34710+34770+34800+34830+34860+34880+35010+35250+35300+35600+35670+35740+35760+35780+35790+35800+36070+36150+36250+36300+36370+36510+36580+36630+36660+36720+36820+36910+36950+36960+37010+37300+37310+37340+37400+37550+37570+37600+39499+39799+40070+40120+40150+40220+40250+40310+40430+40520+40700+40910+41010+41060+41140+41190+41330+41560+41750+41830+41960+42030+42110+42250+42600+42750+43080+43220+43360+43650+43710+43790+44000+44060+44210+44340+44550+44620+44830+45040+45090+45120+45290+45340+45400+45540+45680+45890+46090+46300+46450+46510+46670+46860+46970+47140+47290+47490+47630+47700+47800+47910+47980+48050+48130+48260+48340+48410+48540+48640+48750+48830+49399+49499+49799+50080+50210+50250+50280+50350+50420+50490+50560+50630+50770+50840+50910+50980+51080+51120+51190+51260+51310+51330+51400+51470+51540+51610+51680+51750+51820+51890+51960+52030+52100+52170+52240+52310+52380+52450+52520+52590+52660+52730+52800+52870+52940+53010+53080+53150+53220+53290+53360+53430+53570+53640+53710+53780+53800+53920+53990+54060+54130+54170+54200+54280+54310+54340+54410+54480+54550+54620+54690+54760+54830+54900+54970+55040+55110+55180+55250+55320+55390+55460+55530+55600+55670+55740+55810+55880+55950+56090+56160+56230+56300+56370+56460+56580+56620+56730+56790+56860+56930+57000+57080+57140+57210+57280+57350+57420+57490+57630+57700+57770+57840+57910+57980+58050+58190+58260+58330+58400+58470+58510+58540+58570+58610+58680+58760+58820+58890+59030+59100+59170+59250+59310+59320+59330+59340+59350+59360+59370+59499+59799+60210+60410+60610+60810+61010+61210+61410+61510+61610+61810+62010+62210+62410+62610+62810+63010+63210+63410+63610+63810+64010+64210+64610+64810+65010+65210+65410+65610+65810+69499+69799+70200+70420+70540+70620+70700+71000+71300+72200+72300+72330+72800+73600+74050+74550+74560+74660+74680+79399+79499+79799+89399+89499+89799+99399+99499+99799+0+1+2+3+4+5+6+7+8+9.A?startPeriod=2016&endPeriod=2021&dimensionAtObservation=AllDimensions"



  api_urls <- dplyr::lst(alcohol,
                          lf,
                          lf_time,
                          turnover,
                          erp,
                          erp2)

  api_urls %>%
    purrr::map(read_abs_api) %>%
    purrr::walk(expect_s3_class,
                class = "tbl_df")

})
